<!-- mark down viewer -->
<!DOCTYPE html>
<html>

<head>
  <title>Markdown Viewer</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <script src="js/lib/vue.js"></script>
  <script src="js/lib/jquery-3.2.1.min.js"></script>
  <script src="js/lib/marked.js"></script>
  <script src="js/lib/lodash.js"></script>
  <style>
    html,
    body,
    #editor {
      margin: 0;
      height: 100%;
      font-family: 'Helvetica Neue', Arial, sans-serif;
      color: #333;
    }

    textarea,
    #editor div {
      display: inline-block;
      /* width: 49%; */
      width: 99%;
      height: 100%;
      vertical-align: top;
      box-sizing: border-box;
      padding: 0 20px;
    }

    textarea {
      border: none;
      border-right: 1px solid #ccc;
      resize: none;
      outline: none;
      background-color: #f6f6f6;
      font-size: 14px;
      font-family: 'Monaco', courier, monospace;
      padding: 20px;
    }

    code {
      color: #f66;
    }
  </style>
</head>

<body>
  <div id="editor">
    <!-- markdown源码部分 -->
    <!-- <textarea :value="input" @input="update"></textarea> -->
    <div v-html="compiledMarkdown"></div>
  </div>
</body>
<script>
  var query = window.location.search
  //http://localhost:8080/mdv.html?i=%E6%9B%B4%E6%96%B0%E6%97%A5%E5%BF%97.md
  console.log("[info]", query, ":[query]");
  query = query.replace('?i=', '')
  if (!query) {
  } else {
    $.ajax({
      url: query, dataType: 'text', async: true, success: (txt) => {
        new Vue({
          el: '#editor',
          data: {
            input: txt
          },
          computed: {
            compiledMarkdown: function () {
              return marked(this.input, { sanitize: true })
            }
          },
          methods: {
            update: _.debounce(function (e) {
              this.input = e.target.value
            }, 300)
          }
        })
      }
    })
  }
</script>

</html>